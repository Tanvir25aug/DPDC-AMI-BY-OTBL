# DPDC AMI SYSTEM - COMPLETE FLOWCHART & PAGE-BY-PAGE DOCUMENTATION

---

## TABLE OF CONTENTS

1. [System Architecture Flowchart](#1-system-architecture-flowchart)
2. [Complete Data Flow Diagram](#2-complete-data-flow-diagram)
3. [User Journey Flowcharts](#3-user-journey-flowcharts)
4. [Integration Flowcharts](#4-integration-flowcharts)
5. [Page-by-Page Detailed Documentation](#5-page-by-page-detailed-documentation)
6. [API Endpoint Reference](#6-api-endpoint-reference)
7. [Database Schema Diagrams](#7-database-schema-diagrams)

---

## 1. SYSTEM ARCHITECTURE FLOWCHART

### High-Level System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            DPDC AMI SYSTEM ARCHITECTURE                              â”‚
â”‚                         (Advanced Metering Infrastructure)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   END USERS  â”‚
                                    â”‚ (300K+ Cust) â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                      â”‚                      â”‚
                    â–¼                      â–¼                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   WEB BROWSER   â”‚   â”‚  TELEGRAM BOT   â”‚   â”‚   MS TEAMS      â”‚
         â”‚   (Vue.js 3)    â”‚   â”‚  @DPDC_customer â”‚   â”‚  (Webhooks)     â”‚
         â”‚   Port: 5173    â”‚   â”‚   Info_bot      â”‚   â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                     â”‚                      â”‚
                  â”‚ HTTPS               â”‚ Polling              â”‚ Outgoing
                  â”‚ REST API            â”‚ 300ms                â”‚ Only
                  â”‚                     â”‚                      â”‚
                  â–¼                     â–¼                      â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚              NGINX WEB SERVER (Reverse Proxy)                  â”‚
         â”‚  â€¢ SSL Termination (HTTPS)                                     â”‚
         â”‚  â€¢ Security Headers (HSTS, CSP, X-Frame-Options)              â”‚
         â”‚  â€¢ Rate Limiting (Per IP)                                      â”‚
         â”‚  â€¢ Static File Serving (Frontend Assets)                       â”‚
         â”‚  â€¢ Load Balancing                                              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚           EXPRESS.JS APPLICATION SERVER (Node.js v20+)         â”‚
         â”‚                         Port: 3000                              â”‚
         â”‚                                                                 â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  MIDDLEWARE LAYER (Security & Processing)                â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Helmet.js (XSS, CSP, Frame Guard)                   â”‚ â”‚
         â”‚  â”‚  â”œâ”€ CORS Protection (Origin Validation)                  â”‚ â”‚
         â”‚  â”‚  â”œâ”€ API Protection (Referer, Bot Detection)              â”‚ â”‚
         â”‚  â”‚  â”œâ”€ JWT Authentication (Bearer Token)                    â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Rate Limiting (100 req/15min)                        â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Request Validation                                   â”‚ â”‚
         â”‚  â”‚  â””â”€ Logging (Winston)                                    â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                                 â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  CONTROLLERS (Request Handlers)                          â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Auth Controller (login, register, profile)           â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Reports Controller (38+ report endpoints)            â”‚ â”‚
         â”‚  â”‚  â”œâ”€ User Controller (CRUD operations)                    â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Query Controller (SQL execution)                     â”‚ â”‚
         â”‚  â”‚  â””â”€ Activity Controller (audit logging)                  â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                                 â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  SERVICES LAYER (Business Logic)                         â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Reports Service (SQL file execution)                 â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Auth Service (JWT generation/validation)             â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Telegram Bot Service (customer queries)              â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Teams Service (webhooks & adaptive cards)            â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Batch Monitoring Service (RPS tracking)              â”‚ â”‚
         â”‚  â”‚  â”œâ”€ NOCS Balance Scheduler (hourly cache)                â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Cache Service (in-memory caching)                    â”‚ â”‚
         â”‚  â”‚  â””â”€ PDF Service (report generation)                      â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                                 â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  SCHEDULERS (Background Jobs - node-cron)                â”‚ â”‚
         â”‚  â”‚  â”œâ”€ NOCS Balance Scheduler (Every 60 min)                â”‚ â”‚
         â”‚  â”‚  â”œâ”€ Batch Monitoring Scheduler (Every 30 min)            â”‚ â”‚
         â”‚  â”‚  â””â”€ Teams Reports Scheduler (Every 60 min)               â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â”‚                                                                 â”‚
         â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
         â”‚  â”‚  SOCKET.IO (Real-time Communication)                     â”‚ â”‚
         â”‚  â”‚  â””â”€ Broadcasts scheduler updates, alerts, status         â”‚ â”‚
         â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                          â”‚
                       â–¼                          â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚   POSTGRESQL DATABASE   â”‚   â”‚   ORACLE DATABASE      â”‚
         â”‚   (dpdc_ami_users)      â”‚   â”‚   (CC&B System)         â”‚
         â”‚   Port: 5432            â”‚   â”‚   Port: 1521            â”‚
         â”‚                         â”‚   â”‚                         â”‚
         â”‚   READ/WRITE ACCESS     â”‚   â”‚   READ-ONLY ACCESS      â”‚
         â”‚                         â”‚   â”‚                         â”‚
         â”‚   TABLES:               â”‚   â”‚   TABLES:               â”‚
         â”‚   â€¢ users               â”‚   â”‚   â€¢ ci_acct (Accounts)  â”‚
         â”‚   â€¢ roles               â”‚   â”‚   â€¢ ci_sa (Services)    â”‚
         â”‚   â€¢ login_history       â”‚   â”‚   â€¢ ci_bseg (Bills)     â”‚
         â”‚   â€¢ user_sessions       â”‚   â”‚   â€¢ ci_ft (Finance)     â”‚
         â”‚   â€¢ user_activity       â”‚   â”‚   â€¢ d1_device (Meters)  â”‚
         â”‚   â€¢ nocs_balance_       â”‚   â”‚   â€¢ d1_activity (RC/DC) â”‚
         â”‚   â€¢   summary (CACHE)   â”‚   â”‚   â€¢ ci_batch_job        â”‚
         â”‚   â€¢ batch_execution_log â”‚   â”‚   â€¢ d1_imd_ctrl         â”‚
         â”‚   â€¢ batch_monitoring_   â”‚   â”‚   â€¢ ci_prem_char        â”‚
         â”‚   â€¢   alert             â”‚   â”‚   â€¢ c1_usage            â”‚
         â”‚   â€¢ query_logs          â”‚   â”‚   â€¢ 100+ more tables    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                          â”‚
                       â”‚   Connection Pools       â”‚
                       â”‚   (Pooling Strategy)     â”‚
                       â–¼                          â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  PostgreSQL Pool        â”‚   â”‚  Oracle Pool            â”‚
         â”‚  Min: 5, Max: 20        â”‚   â”‚  Min: 5, Max: 30        â”‚
         â”‚  Timeout: 60s           â”‚   â”‚  Timeout: 120s          â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     EXTERNAL INTEGRATIONS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  TELEGRAM API      â”‚      â”‚  MS TEAMS WEBHOOKS â”‚      â”‚  WHATSAPP    â”‚ â”‚
â”‚  â”‚  (Polling Mode)    â”‚      â”‚  (Push Mode)       â”‚      â”‚  (Planned)   â”‚ â”‚
â”‚  â”‚                    â”‚      â”‚                    â”‚      â”‚              â”‚ â”‚
â”‚  â”‚  Bot Token:        â”‚      â”‚  3 Webhook URLs:   â”‚      â”‚  Status:     â”‚ â”‚
â”‚  â”‚  8575870159:AAH... â”‚      â”‚  â€¢ DEFAULT         â”‚      â”‚  Partial     â”‚ â”‚
â”‚  â”‚                    â”‚      â”‚  â€¢ BATCH_MONITOR   â”‚      â”‚  Impl.       â”‚ â”‚
â”‚  â”‚  Features:         â”‚      â”‚  â€¢ ALERTS          â”‚      â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Customer Search â”‚      â”‚                    â”‚      â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Billing Info    â”‚      â”‚  Card Types:       â”‚      â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Recharge Hist.  â”‚      â”‚  â€¢ Batch Report    â”‚      â”‚              â”‚ â”‚
â”‚  â”‚  â€¢ Balance Check   â”‚      â”‚  â€¢ NOCS Balance    â”‚      â”‚              â”‚ â”‚
â”‚  â”‚                    â”‚      â”‚  â€¢ Stuck Alert     â”‚      â”‚              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. COMPLETE DATA FLOW DIAGRAM

### Main Data Flow Paths

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          DATA FLOW ARCHITECTURE                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 1: USER AUTHENTICATION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User enters credentials
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Login Page        â”‚ POST /api/auth/login
â”‚  (Vue Component)   â”‚ { username, password }
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Auth Controller                                                   â”‚
â”‚  â”œâ”€ Validate input                                                â”‚
â”‚  â”œâ”€ Find user in PostgreSQL (users table)                         â”‚
â”‚  â”œâ”€ Compare password (bcrypt.compare)                             â”‚
â”‚  â”œâ”€ Check user status (active/inactive)                           â”‚
â”‚  â”œâ”€ Generate JWT token (jwt.sign)                                 â”‚
â”‚  â”œâ”€ Generate refresh token                                        â”‚
â”‚  â”œâ”€ Log login (login_history table)                               â”‚
â”‚  â””â”€ Create session (user_sessions table)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response          â”‚ { success: true, token, refreshToken, user }
â”‚  Status: 200       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Storage                                                  â”‚
â”‚  â”œâ”€ Store in Pinia authStore (reactive state)                     â”‚
â”‚  â”œâ”€ Store in localStorage (persistence)                           â”‚
â”‚  â”‚   â€¢ token: "eyJhbGciOiJIUzI1NiIsInR..."                        â”‚
â”‚  â”‚   â€¢ user: { id, username, role, ... }                          â”‚
â”‚  â””â”€ Axios interceptor adds Bearer token to all requests           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Redirect to       â”‚ router.push('/dashboard')
â”‚  Dashboard         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 2: REPORT EXECUTION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User selects report â†’ Inputs parameters â†’ Clicks "Execute"
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Report View       â”‚ GET /api/reports/nocs-balance-summary
â”‚  (Vue Component)   â”‚ Headers: { Authorization: "Bearer {token}" }
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Middleware Chain                                                  â”‚
â”‚  â”œâ”€ JWT Authentication (verify token)                             â”‚
â”‚  â”‚   â””â”€ Decode token, extract user ID, check expiry              â”‚
â”‚  â”œâ”€ API Protection (check referer, user agent)                    â”‚
â”‚  â”œâ”€ Rate Limiting (check request count)                           â”‚
â”‚  â””â”€ Log request (user_activity table)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reports Controller                                                â”‚
â”‚  â”œâ”€ Parse request parameters                                      â”‚
â”‚  â”œâ”€ Validate parameters                                           â”‚
â”‚  â”œâ”€ Check cache first (for cached reports)                        â”‚
â”‚  â””â”€ Call Reports Service                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reports Service                                                   â”‚
â”‚  â”œâ”€ Locate SQL file (backend/reports/{report_name}.sql)           â”‚
â”‚  â”œâ”€ Read SQL content                                              â”‚
â”‚  â”œâ”€ Replace bind parameters (:param â†’ value)                      â”‚
â”‚  â”œâ”€ Validate SQL (no INSERT/UPDATE/DELETE/DROP)                   â”‚
â”‚  â””â”€ Prepare for execution                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Oracle Connection Pool                                            â”‚
â”‚  â”œâ”€ Get connection from pool (wait if pool full)                  â”‚
â”‚  â”œâ”€ Connection wait timeout: 120 seconds                          â”‚
â”‚  â”œâ”€ Pool stats: [Used: 15/30, Available: 15, Pending: 2]         â”‚
â”‚  â””â”€ Connection acquired                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Oracle Database Execution                                         â”‚
â”‚  â”œâ”€ Execute SQL query with bind params                            â”‚
â”‚  â”œâ”€ Oracle query optimizer processes query                        â”‚
â”‚  â”œâ”€ Parallel execution hints (/*+ PARALLEL(4) */)                 â”‚
â”‚  â”œâ”€ Index lookups (indexed columns)                               â”‚
â”‚  â”œâ”€ Join operations (INNER JOIN, LEFT JOIN)                       â”‚
â”‚  â”œâ”€ Aggregations (SUM, COUNT, AVG)                                â”‚
â”‚  â””â”€ Result set generated                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Result Processing                                                 â”‚
â”‚  â”œâ”€ Fetch all rows (or paginated rows)                            â”‚
â”‚  â”œâ”€ Convert Oracle types to JavaScript types                      â”‚
â”‚  â”œâ”€ Format numbers, dates, strings                                â”‚
â”‚  â”œâ”€ Release connection back to pool                               â”‚
â”‚  â””â”€ Return formatted results                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reports Service (Post-processing)                                 â”‚
â”‚  â”œâ”€ Apply business logic transformations                          â”‚
â”‚  â”œâ”€ Calculate derived metrics                                     â”‚
â”‚  â”œâ”€ Log query execution (query_logs table in PostgreSQL)          â”‚
â”‚  â”‚   â€¢ query_text, execution_time, row_count, user_id            â”‚
â”‚  â””â”€ Return to controller                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Response          â”‚ { success: true, data: [...], count: 150 }
â”‚  Status: 200       â”‚ Execution time: 2.34s
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Frontend Processing                                               â”‚
â”‚  â”œâ”€ Receive data in Vue component                                 â”‚
â”‚  â”œâ”€ Store in reactive ref: data.value = response.data            â”‚
â”‚  â”œâ”€ Render in table/chart component                               â”‚
â”‚  â”œâ”€ Apply client-side filtering/sorting                           â”‚
â”‚  â”œâ”€ Pagination controls                                           â”‚
â”‚  â””â”€ Export functionality (CSV, Excel, PDF)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 3: NOCS BALANCE CACHING FLOW (Background Scheduler)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Every 60 minutes (Cron: 0 * * * *)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NOCS Balance Scheduler (node-cron)                                â”‚
â”‚  â”œâ”€ Trigger time: XX:00:00                                         â”‚
â”‚  â”œâ”€ Check if previous run completed                                â”‚
â”‚  â””â”€ Start new run                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Execute Heavy Oracle Query                                        â”‚
â”‚  â”œâ”€ SQL: nocs_balance_summary.sql                                 â”‚
â”‚  â”œâ”€ Scans: 300,000+ customer records                              â”‚
â”‚  â”œâ”€ Joins: ci_ft, ci_sa, ci_acct, ci_prem_char                    â”‚
â”‚  â”œâ”€ Aggregations: SUM(TOT_AMT), COUNT(*) per NOCS                 â”‚
â”‚  â”œâ”€ Parallel execution: 4 threads                                 â”‚
â”‚  â”œâ”€ Duration: 5-10 minutes (typical)                              â”‚
â”‚  â””â”€ Result: 25 rows (one per NOCS)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL Transaction (Caching)                                  â”‚
â”‚  â”œâ”€ BEGIN TRANSACTION                                             â”‚
â”‚  â”œâ”€ TRUNCATE nocs_balance_summary                                 â”‚
â”‚  â”œâ”€ Bulk INSERT new data (25 rows)                                â”‚
â”‚  â”‚   â€¢ nocs_code, nocs_name                                       â”‚
â”‚  â”‚   â€¢ total_customers, credit_qty, credit_balance               â”‚
â”‚  â”‚   â€¢ due_qty, due_balance, net_balance                         â”‚
â”‚  â”‚   â€¢ last_updated, cache_duration                              â”‚
â”‚  â”œâ”€ COMMIT TRANSACTION                                            â”‚
â”‚  â””â”€ Cache updated successfully                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Users Request     â”‚ GET /api/reports/nocs-balance-summary
â”‚  NOCS Balance      â”‚ (from web UI or scheduled Teams report)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Reports Controller                                                â”‚
â”‚  â”œâ”€ Check cache strategy: PostgreSQL                              â”‚
â”‚  â”œâ”€ Query nocs_balance_summary table                              â”‚
â”‚  â”œâ”€ Response time: <0.1 seconds (cached!)                         â”‚
â”‚  â”œâ”€ Include metadata: lastUpdated, ageMinutes                     â”‚
â”‚  â””â”€ Return cached data                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Instant Response  â”‚ { success: true, data: [...], cached: true,
â”‚  to User           â”‚   lastUpdated: "2025-01-15 14:00:00" }
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 4: BATCH MONITORING FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Every 30 minutes (Cron: */30 * * * *)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Batch Monitoring Scheduler                                        â”‚
â”‚  â”œâ”€ Check if previous job running                                 â”‚
â”‚  â”œâ”€ Set isRunning = true                                          â”‚
â”‚  â””â”€ Start monitoring cycle                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Get Pending IMD Count                                     â”‚
â”‚  â”œâ”€ Query Oracle: d1_imd_ctrl table                               â”‚
â”‚  â”œâ”€ WHERE: MDT_STATUS = 'P' (Pending)                             â”‚
â”‚  â”œâ”€ Result: e.g., 15,234 pending records                          â”‚
â”‚  â””â”€ Store for report                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Monitor Running Batches                                   â”‚
â”‚  â”œâ”€ Query Oracle: ci_batch_run, ci_batch_job                      â”‚
â”‚  â”œâ”€ WHERE: run_status = 'Running'                                 â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”‚  FOR EACH running batch:                                       â”‚
â”‚  â”‚  â”œâ”€ Get batch_code (e.g., "BMHHS", "BMUPLD")                  â”‚
â”‚  â”‚  â”œâ”€ Get start_time                                             â”‚
â”‚  â”‚  â”œâ”€ Calculate duration (now - start_time)                      â”‚
â”‚  â”‚  â”œâ”€ Count records processed                                    â”‚
â”‚  â”‚  â”œâ”€ Calculate RPS (Records Per Second)                         â”‚
â”‚  â”‚  â”‚   RPS = total_records / duration_seconds                    â”‚
â”‚  â”‚  â”‚                                                              â”‚
â”‚  â”‚  â”œâ”€ Get previous check data (PostgreSQL)                       â”‚
â”‚  â”‚  â”œâ”€ Compare records: current vs previous                       â”‚
â”‚  â”‚  â”œâ”€ Detect stuck condition:                                    â”‚
â”‚  â”‚  â”‚   â€¢ Duration > 2 hours = STUCK                              â”‚
â”‚  â”‚  â”‚   â€¢ Duration 1-2 hours + low RPS = ALERT                    â”‚
â”‚  â”‚  â”‚   â€¢ Records not increasing = STUCK                          â”‚
â”‚  â”‚  â”‚   â€¢ RPS < 1 + duration > 10 min = STUCK                    â”‚
â”‚  â”‚  â”‚                                                              â”‚
â”‚  â”‚  â””â”€ Build batch object:                                        â”‚
â”‚  â”‚      {                                                          â”‚
â”‚  â”‚        batchCode: "BMHHS",                                     â”‚
â”‚  â”‚        startTime: "2025-01-15 12:00:00",                       â”‚
â”‚  â”‚        duration: 7200, // seconds                              â”‚
â”‚  â”‚        totalRecords: 125430,                                   â”‚
â”‚  â”‚        rps: 17.42,                                             â”‚
â”‚  â”‚        status: "Running",                                      â”‚
â”‚  â”‚        stuckDetection: {                                       â”‚
â”‚  â”‚          isStuck: true,                                        â”‚
â”‚  â”‚          reason: "Duration > 2 hours and RPS < 50"            â”‚
â”‚  â”‚        }                                                        â”‚
â”‚  â”‚      }                                                          â”‚
â”‚  â””â”€ Result: Array of batch objects                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Save to PostgreSQL                                        â”‚
â”‚  â”œâ”€ INSERT INTO batch_execution_log                               â”‚
â”‚  â”‚   (batch_code, check_time, total_records, rps, duration, ...)â”‚
â”‚  â”œâ”€ Used for historical analysis                                  â”‚
â”‚  â””â”€ Used for stuck detection comparison                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: Get Batch Statistics (Last 24 hours)                      â”‚
â”‚  â”œâ”€ Query PostgreSQL: batch_execution_log                         â”‚
â”‚  â”œâ”€ WHERE: check_time > NOW() - INTERVAL '24 hours'              â”‚
â”‚  â”œâ”€ GROUP BY: batch_code                                          â”‚
â”‚  â”œâ”€ Calculate:                                                     â”‚
â”‚  â”‚   â€¢ AVG(rps) - Average RPS                                     â”‚
â”‚  â”‚   â€¢ MAX(rps) - Peak RPS                                        â”‚
â”‚  â”‚   â€¢ MAX(total_records) - Peak records                          â”‚
â”‚  â”‚   â€¢ COUNT(*) - Number of checks                                â”‚
â”‚  â””â”€ Result: Statistics per batch                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: Check for Stuck Batches                                   â”‚
â”‚  â”œâ”€ Filter batches where stuckDetection.isStuck === true          â”‚
â”‚  â”œâ”€ IF stuck batches found:                                       â”‚
â”‚  â”‚   FOR EACH stuck batch:                                        â”‚
â”‚  â”‚   â”œâ”€ Check if alert already sent (batch_monitoring_alert)     â”‚
â”‚  â”‚   â”œâ”€ IF not sent:                                              â”‚
â”‚  â”‚   â”‚   â”œâ”€ Send MS Teams Alert (ALERTS webhook)                 â”‚
â”‚  â”‚   â”‚   â”œâ”€ Format: Adaptive Card with batch details             â”‚
â”‚  â”‚   â”‚   â””â”€ Mark as sent in database                             â”‚
â”‚  â”‚   â””â”€ ELSE: Skip (alert already sent)                          â”‚
â”‚  â””â”€ Continue to regular report                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 6: Send MS Teams Monitoring Report                           â”‚
â”‚  â”œâ”€ Initialize Teams Service                                      â”‚
â”‚  â”œâ”€ Webhook: BATCH_MONITORING                                     â”‚
â”‚  â”œâ”€ Format Adaptive Card:                                         â”‚
â”‚  â”‚   â€¢ Title: "ğŸ”„ BATCH MONITORING REPORT"                        â”‚
â”‚  â”‚   â€¢ Pending IMD: 15,234 records                                â”‚
â”‚  â”‚   â€¢ Running Batches: 3                                         â”‚
â”‚  â”‚   â€¢ FOR EACH batch:                                            â”‚
â”‚  â”‚     - Batch Code (with status icon)                            â”‚
â”‚  â”‚     - RPS (color-coded: ğŸŸ¢>100, ğŸŸ¡50-100, ğŸ”´<50)              â”‚
â”‚  â”‚     - Start Time, Duration, Records                            â”‚
â”‚  â”‚   â€¢ 24-Hour Statistics per batch                               â”‚
â”‚  â”‚   â€¢ Timestamp                                                  â”‚
â”‚  â”œâ”€ POST to Teams Webhook                                         â”‚
â”‚  â””â”€ Log success/failure                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MS Teams Channel  â”‚ Report displayed as Adaptive Card
â”‚  Receives Report   â”‚ Team members notified
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 5: TELEGRAM BOT INTERACTION FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User sends message to @DPDC_customerInfo_bot
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Telegram Bot Service (Polling Mode - 300ms interval)              â”‚
â”‚  â”œâ”€ Poll Telegram API for new updates                             â”‚
â”‚  â”œâ”€ GET https://api.telegram.org/bot{token}/getUpdates            â”‚
â”‚  â”œâ”€ Receive update:                                               â”‚
â”‚  â”‚   {                                                             â”‚
â”‚  â”‚     update_id: 123456,                                         â”‚
â”‚  â”‚     message: {                                                 â”‚
â”‚  â”‚       chat: { id: 789012, username: "john_doe" },            â”‚
â”‚  â”‚       text: "12345678"  // Customer ID                        â”‚
â”‚  â”‚     }                                                           â”‚
â”‚  â”‚   }                                                             â”‚
â”‚  â””â”€ Parse message                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Message Processing                                                â”‚
â”‚  â”œâ”€ Identify message type:                                        â”‚
â”‚  â”‚   â€¢ /start command â†’ Show welcome message                      â”‚
â”‚  â”‚   â€¢ Customer ID (digits) â†’ Search customer                     â”‚
â”‚  â”‚   â€¢ Meter number â†’ Search by meter                             â”‚
â”‚  â”‚   â€¢ Callback query (button press) â†’ Handle action             â”‚
â”‚  â””â”€ Route to appropriate handler                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Customer Search Handler                                           â”‚
â”‚  â”œâ”€ Extract customer ID from message text                         â”‚
â”‚  â”œâ”€ Validate format (numeric, length)                             â”‚
â”‚  â””â”€ Execute Oracle queries in parallel:                           â”‚
â”‚                                                                     â”‚
â”‚     QUERY 1: Customer Details                                      â”‚
â”‚     â”œâ”€ SQL: customer_details_search.sql                           â”‚
â”‚     â”œâ”€ Bind: { searchValue: "12345678" }                          â”‚
â”‚     â”œâ”€ Returns: customer_no, meter_no, name, address, nocs,      â”‚
â”‚     â”‚          connection_date, status                            â”‚
â”‚     â””â”€ Duration: ~0.5s                                            â”‚
â”‚                                                                     â”‚
â”‚     QUERY 2: Billing Details                                       â”‚
â”‚     â”œâ”€ SQL: customer_billing_details.sql                          â”‚
â”‚     â”œâ”€ Bind: { custId: "12345678", startDate: null }             â”‚
â”‚     â”œâ”€ Returns: Daily billing records (start_dt, end_dt,         â”‚
â”‚     â”‚          quantity, daily_charges, payoff_bal)               â”‚
â”‚     â””â”€ Duration: ~1.5s                                            â”‚
â”‚                                                                     â”‚
â”‚     QUERY 3: Recharge History                                      â”‚
â”‚     â”œâ”€ SQL: customer_recharge_history.sql                         â”‚
â”‚     â”œâ”€ Bind: { saId: customer.SA_ID }                            â”‚
â”‚     â”œâ”€ Returns: Transaction dates, amounts, payment methods       â”‚
â”‚     â””â”€ Duration: ~0.8s                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Data Aggregation & Processing                                     â”‚
â”‚  â”œâ”€ Aggregate daily billing to monthly:                           â”‚
â”‚  â”‚   FOR EACH month in billing data:                              â”‚
â”‚  â”‚   â”œâ”€ Group records by year-month                               â”‚
â”‚  â”‚   â”œâ”€ SUM(daily_charges) â†’ monthly_charges                      â”‚
â”‚  â”‚   â”œâ”€ SUM(quantity) â†’ monthly_consumption                       â”‚
â”‚  â”‚   â””â”€ COUNT(*) â†’ billing_days                                   â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”œâ”€ Calculate analytics:                                          â”‚
â”‚  â”‚   â€¢ Total consumption (kWh)                                    â”‚
â”‚  â”‚   â€¢ Total charges (Taka)                                       â”‚
â”‚  â”‚   â€¢ Average daily consumption                                  â”‚
â”‚  â”‚   â€¢ Current balance (reverse sign: DB * -1)                    â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”œâ”€ Sort recharge history by date (newest first)                  â”‚
â”‚  â””â”€ Calculate total recharge amount                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Session Storage (In-Memory Map)                                   â”‚
â”‚  â”œâ”€ Key: chatId (user's Telegram chat ID)                         â”‚
â”‚  â”œâ”€ Value: {                                                       â”‚
â”‚  â”‚   customerInfo: { ... },                                       â”‚
â”‚  â”‚   billingData: [ ... ],                                        â”‚
â”‚  â”‚   monthlyBilling: [ ... ],                                     â”‚
â”‚  â”‚   rechargeHistory: [ ... ],                                    â”‚
â”‚  â”‚   analytics: { ... },                                          â”‚
â”‚  â”‚   timestamp: Date.now()                                        â”‚
â”‚  â”‚ }                                                               â”‚
â”‚  â””â”€ TTL: 30 minutes (auto-cleanup)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Send Interactive Menu to User                                     â”‚
â”‚  â”œâ”€ Format message:                                               â”‚
â”‚  â”‚   "âœ… Customer Found!                                          â”‚
â”‚  â”‚    Customer No: 12345678                                       â”‚
â”‚  â”‚    Meter No: 987654321                                         â”‚
â”‚  â”‚    NOCS: Mirpur                                                â”‚
â”‚  â”‚    Status: Connected                                           â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”‚    Select an option:"                                          â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”œâ”€ Add Inline Keyboard buttons:                                  â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚   â”‚ ğŸ“Š Customer Info    â”‚ ğŸ’° Current Balance  â”‚              â”‚
â”‚  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚   â”‚ ğŸ“ˆ Monthly Billing  â”‚ ğŸ’³ Recharge History â”‚              â”‚
â”‚  â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤              â”‚
â”‚  â”‚   â”‚        ğŸ” Search Another Customer         â”‚              â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”‚   callback_data for each button:                               â”‚
â”‚  â”‚   â€¢ "info_12345678"                                           â”‚
â”‚  â”‚   â€¢ "balance_12345678"                                        â”‚
â”‚  â”‚   â€¢ "billing_12345678"                                        â”‚
â”‚  â”‚   â€¢ "recharge_12345678"                                       â”‚
â”‚  â”‚   â€¢ "search_new"                                              â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â””â”€ POST to Telegram API: sendMessage                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User's Telegram   â”‚ Message displayed with interactive buttons
â”‚  App Displays      â”‚ User can click any button
â”‚  Message           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Clicks Button (e.g., "Monthly Billing")                      â”‚
â”‚  â”œâ”€ Telegram sends callback_query to bot                          â”‚
â”‚  â”œâ”€ callback_data: "billing_12345678"                             â”‚
â”‚  â””â”€ Bot receives callback                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Callback Query Handler                                            â”‚
â”‚  â”œâ”€ Parse callback_data                                           â”‚
â”‚  â”œâ”€ Action: "billing", Customer: "12345678"                       â”‚
â”‚  â”œâ”€ Retrieve from session (chatId)                                â”‚
â”‚  â”œâ”€ Get monthlyBilling array                                      â”‚
â”‚  â””â”€ Format response                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Format & Send Billing Report                                      â”‚
â”‚  â”œâ”€ Create formatted message:                                     â”‚
â”‚  â”‚   "ğŸ“ˆ Monthly Billing Report                                   â”‚
â”‚  â”‚    Customer: 12345678                                          â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”‚    January 2025:                                               â”‚
â”‚  â”‚    â€¢ Consumption: 245 kWh                                      â”‚
â”‚  â”‚    â€¢ Charges: à§³1,234.50                                        â”‚
â”‚  â”‚    â€¢ Days: 31                                                  â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”‚    December 2024:                                              â”‚
â”‚  â”‚    â€¢ Consumption: 198 kWh                                      â”‚
â”‚  â”‚    â€¢ Charges: à§³998.00                                          â”‚
â”‚  â”‚    â€¢ Days: 31                                                  â”‚
â”‚  â”‚    ..."                                                         â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”œâ”€ Add "Back to Menu" button                                     â”‚
â”‚  â””â”€ POST to Telegram API: editMessageText                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Sees Report  â”‚ Can navigate back or choose another option
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


PATH 6: FRONTEND COMPONENT RENDERING FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User navigates to page (e.g., /nocs-balance-summary)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vue Router                                                        â”‚
â”‚  â”œâ”€ Match route: /nocs-balance-summary                            â”‚
â”‚  â”œâ”€ Check route guard (authentication)                            â”‚
â”‚  â”‚   â€¢ If not authenticated â†’ redirect to /login                  â”‚
â”‚  â”‚   â€¢ If authenticated â†’ proceed                                 â”‚
â”‚  â”œâ”€ Load component: NocsBalanceSummaryView.vue                    â”‚
â”‚  â””â”€ Lazy loading with code splitting                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component Lifecycle: onMounted()                                  â”‚
â”‚  â”œâ”€ Component instance created                                    â”‚
â”‚  â”œâ”€ Reactive refs initialized:                                    â”‚
â”‚  â”‚   â€¢ data = ref([])                                             â”‚
â”‚  â”‚   â€¢ loading = ref(false)                                       â”‚
â”‚  â”‚   â€¢ error = ref(null)                                          â”‚
â”‚  â”œâ”€ Computed properties prepared:                                 â”‚
â”‚  â”‚   â€¢ summary, filteredData, paginatedData                       â”‚
â”‚  â””â”€ onMounted hook executes â†’ fetchData()                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  fetchData() Method                                                â”‚
â”‚  â”œâ”€ Set loading.value = true                                      â”‚
â”‚  â”œâ”€ Clear previous errors                                         â”‚
â”‚  â”œâ”€ Construct API request:                                        â”‚
â”‚  â”‚   â€¢ Method: GET                                                â”‚
â”‚  â”‚   â€¢ URL: /api/reports/nocs-balance-summary                     â”‚
â”‚  â”‚   â€¢ Headers: { Authorization: "Bearer {token}" }              â”‚
â”‚  â””â”€ Execute Axios request                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Axios Request Interceptor (frontend/src/services/api.js)          â”‚
â”‚  â”œâ”€ Get token from Pinia authStore                                â”‚
â”‚  â”œâ”€ Add Authorization header                                      â”‚
â”‚  â”œâ”€ Add Content-Type: application/json                            â”‚
â”‚  â””â”€ Send request to backend                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
     [Backend Processing - See PATH 2]
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Axios Response Interceptor                                        â”‚
â”‚  â”œâ”€ Receive response from backend                                 â”‚
â”‚  â”œâ”€ Check status code:                                            â”‚
â”‚  â”‚   â€¢ 200-299: Success â†’ return response                         â”‚
â”‚  â”‚   â€¢ 401: Unauthorized â†’ logout & redirect to login            â”‚
â”‚  â”‚   â€¢ 403: Forbidden â†’ show permission error                     â”‚
â”‚  â”‚   â€¢ 500: Server error â†’ show error message                     â”‚
â”‚  â””â”€ Return response or throw error                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Component: Handle Response                                        â”‚
â”‚  â”œâ”€ Success path:                                                 â”‚
â”‚  â”‚   â€¢ data.value = response.data.data                            â”‚
â”‚  â”‚   â€¢ Extract metadata (lastUpdated, cached, etc.)              â”‚
â”‚  â”‚   â€¢ loading.value = false                                      â”‚
â”‚  â”‚   â€¢ Trigger Vue reactivity â†’ DOM update                        â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â””â”€ Error path:                                                   â”‚
â”‚      â€¢ error.value = error.message                                â”‚
â”‚      â€¢ loading.value = false                                      â”‚
â”‚      â€¢ Display error message in UI                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vue Reactivity System                                             â”‚
â”‚  â”œâ”€ data.value changed â†’ trigger computed properties              â”‚
â”‚  â”œâ”€ Computed: summary (aggregate calculations)                    â”‚
â”‚  â”œâ”€ Computed: filteredData (apply search filter)                  â”‚
â”‚  â”œâ”€ Computed: paginatedData (slice for current page)              â”‚
â”‚  â””â”€ Reactive dependencies updated                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Template Rendering (Virtual DOM)                                  â”‚
â”‚  â”œâ”€ Vue renders template with updated data:                       â”‚
â”‚  â”‚   <div v-if="loading">Loading...</div>                         â”‚
â”‚  â”‚   <div v-else-if="error">Error: {{ error }}</div>             â”‚
â”‚  â”‚   <div v-else>                                                 â”‚
â”‚  â”‚     <!-- Summary Cards -->                                     â”‚
â”‚  â”‚     <div v-for="nocs in paginatedData" :key="nocs.code">      â”‚
â”‚  â”‚       <h3>{{ nocs.name }}</h3>                                 â”‚
â”‚  â”‚       <p>Customers: {{ nocs.customers }}</p>                   â”‚
â”‚  â”‚       <p>Balance: {{ formatCurrency(nocs.balance) }}</p>       â”‚
â”‚  â”‚     </div>                                                     â”‚
â”‚  â”‚   </div>                                                       â”‚
â”‚  â”‚                                                                 â”‚
â”‚  â”œâ”€ Create Virtual DOM tree                                       â”‚
â”‚  â”œâ”€ Diff with previous Virtual DOM                                â”‚
â”‚  â””â”€ Calculate minimal DOM updates needed                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DOM Update (Actual Browser DOM)                                   â”‚
â”‚  â”œâ”€ Apply patches to real DOM                                     â”‚
â”‚  â”œâ”€ Update only changed elements                                  â”‚
â”‚  â”œâ”€ Trigger CSS transitions/animations                            â”‚
â”‚  â””â”€ Browser repaints/reflows                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User Sees Page    â”‚ Fully rendered with data
â”‚  with Data         â”‚ Can interact with UI elements
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. USER JOURNEY FLOWCHARTS

### Journey 1: New User Login & First Report

```
START: User opens application (http://your-domain.com)
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser loads index.html                 â”‚
â”‚ â”œâ”€ Vite dev server or Nginx             â”‚
â”‚ â”œâ”€ Load bundled JavaScript               â”‚
â”‚ â”œâ”€ Initialize Vue app                    â”‚
â”‚ â””â”€ Mount to #app div                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Vue Router checks authentication         â”‚
â”‚ â”œâ”€ Check authStore.isAuthenticated       â”‚
â”‚ â”œâ”€ Check localStorage for token          â”‚
â”‚ â””â”€ Result: NOT AUTHENTICATED             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redirect to /login                       â”‚
â”‚ LoginView component loads                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Enter credentials           â”‚
â”‚ â€¢ Username: john_admin                   â”‚
â”‚ â€¢ Password: SecurePass123!               â”‚
â”‚ â€¢ Click "Login" button                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend validation                      â”‚
â”‚ â”œâ”€ Check username not empty              â”‚
â”‚ â”œâ”€ Check password not empty              â”‚
â”‚ â””â”€ Validation passed                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /api/auth/login                     â”‚
â”‚ Request body: { username, password }     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: Auth Controller                 â”‚
â”‚ â”œâ”€ Find user in PostgreSQL               â”‚
â”‚ â”œâ”€ Compare password hash                 â”‚
â”‚ â”œâ”€ Generate JWT token                    â”‚
â”‚ â”œâ”€ Log login (login_history)             â”‚
â”‚ â””â”€ Return: { token, user, refreshToken } â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: Store auth data                â”‚
â”‚ â”œâ”€ authStore.setUser(user)               â”‚
â”‚ â”œâ”€ authStore.setToken(token)             â”‚
â”‚ â”œâ”€ localStorage.setItem('token', token)  â”‚
â”‚ â””â”€ isAuthenticated = true                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redirect to /dashboard                   â”‚
â”‚ DashboardView component loads            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dashboard displays:                      â”‚
â”‚ â”œâ”€ Welcome message: "Welcome, John!"     â”‚
â”‚ â”œâ”€ Summary cards (total customers, etc.) â”‚
â”‚ â”œâ”€ Quick links to reports                â”‚
â”‚ â””â”€ User role: Admin                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click "NOCS Balance"        â”‚
â”‚ Navigate to /nocs-balance-summary        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NocsBalanceSummaryView loads             â”‚
â”‚ â”œâ”€ Show loading spinner                  â”‚
â”‚ â”œâ”€ onMounted() â†’ fetchData()             â”‚
â”‚ â””â”€ GET /api/reports/nocs-balance-summary â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: Reports Controller              â”‚
â”‚ â”œâ”€ Check PostgreSQL cache                â”‚
â”‚ â”œâ”€ Return cached data (< 0.1s)           â”‚
â”‚ â””â”€ Response: { data: [...], cached: true}â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: Render data                    â”‚
â”‚ â”œâ”€ Hide loading spinner                  â”‚
â”‚ â”œâ”€ Display summary cards:                â”‚
â”‚ â”‚   â€¢ Total NOCS: 25                     â”‚
â”‚ â”‚   â€¢ Total Customers: 350,000           â”‚
â”‚ â”‚   â€¢ Net Balance: à§³4.3M                 â”‚
â”‚ â”œâ”€ Display table with 25 rows            â”‚
â”‚ â””â”€ Show "Last updated: 2 min ago"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click NOCS row              â”‚
â”‚ Navigate to /nocs-customer-payoff        â”‚
â”‚ with query: ?nocs=ABC001&name=Mirpur     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NocsCustomerPayoffView loads             â”‚
â”‚ â”œâ”€ Show loading spinner                  â”‚
â”‚ â”œâ”€ GET /api/reports/nocs-customer-payoff â”‚
â”‚ â”‚   /ABC001                              â”‚
â”‚ â””â”€ Execute Oracle query (3-5s)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend: Execute query                   â”‚
â”‚ â”œâ”€ Query: nocs_customer_payoff.sql       â”‚
â”‚ â”œâ”€ Bind: { nocs_code: 'ABC001' }        â”‚
â”‚ â”œâ”€ Oracle scans ~15,000 customers        â”‚
â”‚ â”œâ”€ Calculate payoff balance per customer â”‚
â”‚ â”œâ”€ Order by balance DESC                 â”‚
â”‚ â””â”€ Return 15,000 rows                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: Render customer list           â”‚
â”‚ â”œâ”€ Hide loading spinner                  â”‚
â”‚ â”œâ”€ Display summary:                      â”‚
â”‚ â”‚   â€¢ Total Customers: 15,000            â”‚
â”‚ â”‚   â€¢ Total Balance: à§³1.2M               â”‚
â”‚ â”‚   â€¢ Credit: 8,500 customers            â”‚
â”‚ â”‚   â€¢ Due: 6,500 customers               â”‚
â”‚ â”œâ”€ Display paginated table (50 per page) â”‚
â”‚ â”œâ”€ Search box for filtering              â”‚
â”‚ â””â”€ Export to Excel button                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Search for customer         â”‚
â”‚ Type "12345678" in search box            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: Client-side filtering          â”‚
â”‚ â”œâ”€ Computed: filteredData                â”‚
â”‚ â”œâ”€ Filter by customer ID, name, address  â”‚
â”‚ â”œâ”€ Result: 1 matching customer           â”‚
â”‚ â””â”€ Re-render table with filtered data    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click "Export to Excel"     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend: Generate Excel file            â”‚
â”‚ â”œâ”€ Use XLSX library                      â”‚
â”‚ â”œâ”€ Convert filtered data to sheet        â”‚
â”‚ â”œâ”€ Add headers and formatting            â”‚
â”‚ â”œâ”€ Create workbook                       â”‚
â”‚ â”œâ”€ Filename: Customer_Payoff_ABC001_     â”‚
â”‚ â”‚            2025-01-15.xlsx             â”‚
â”‚ â””â”€ Trigger browser download              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Browser downloads file                   â”‚
â”‚ User can open in Excel/LibreOffice       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
                  END
```

### Journey 2: Telegram Bot Customer Inquiry

```
START: Customer needs billing information
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Open Telegram               â”‚
â”‚ Search for @DPDC_customerInfo_bot        â”‚
â”‚ OR click shared link                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Send /start command         â”‚
â”‚ or just start conversation               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot receives /start                      â”‚
â”‚ â”œâ”€ Telegram API sends update to bot     â”‚
â”‚ â”œâ”€ Bot polling receives update           â”‚
â”‚ â””â”€ Parse command                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot sends welcome message:               â”‚
â”‚                                          â”‚
â”‚ "ğŸ‘‹ Welcome to DPDC Customer Info Bot!   â”‚
â”‚                                          â”‚
â”‚ I can help you get:                      â”‚
â”‚ â€¢ Customer Information                   â”‚
â”‚ â€¢ Billing Details                        â”‚
â”‚ â€¢ Recharge History                       â”‚
â”‚ â€¢ Current Balance                        â”‚
â”‚                                          â”‚
â”‚ Please send me your Customer ID or       â”‚
â”‚ Meter Number to get started."            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Type customer ID            â”‚
â”‚ Message: "12345678"                      â”‚
â”‚ Press Send                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot receives message                     â”‚
â”‚ â”œâ”€ Text: "12345678"                      â”‚
â”‚ â”œâ”€ Chat ID: 789012                       â”‚
â”‚ â””â”€ Validate: Is numeric? Length OK?      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot sends "searching" message:           â”‚
â”‚ "ğŸ” Searching for customer 12345678...   â”‚
â”‚ Please wait..."                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execute Oracle queries (3 parallel)      â”‚
â”‚ â”œâ”€ Query 1: Customer details (~0.5s)     â”‚
â”‚ â”œâ”€ Query 2: Billing history (~1.5s)      â”‚
â”‚ â””â”€ Query 3: Recharge history (~0.8s)     â”‚
â”‚ Total duration: ~1.5s (parallel)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                   â”‚
         â–¼                   â–¼
    FOUND                NOT FOUND
         â”‚                   â”‚
         â”‚                   â–¼
         â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚          â”‚ Bot sends error:     â”‚
         â”‚          â”‚ "âŒ Customer not foundâ”‚
         â”‚          â”‚ Please check ID and  â”‚
         â”‚          â”‚ try again."          â”‚
         â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                   â”‚
         â”‚                   â–¼
         â”‚                  END
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Process & aggregate data                 â”‚
â”‚ â”œâ”€ Aggregate daily â†’ monthly billing     â”‚
â”‚ â”œâ”€ Calculate total consumption           â”‚
â”‚ â”œâ”€ Calculate total charges               â”‚
â”‚ â”œâ”€ Reverse balance sign (DB * -1)        â”‚
â”‚ â””â”€ Format data for display               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Store in session (in-memory)             â”‚
â”‚ â”œâ”€ Key: chatId (789012)                  â”‚
â”‚ â”œâ”€ Value: { customerInfo, billing, ... } â”‚
â”‚ â””â”€ TTL: 30 minutes                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot sends interactive menu:              â”‚
â”‚                                          â”‚
â”‚ "âœ… Customer Found!                      â”‚
â”‚                                          â”‚
â”‚ ğŸ‘¤ Customer No: 12345678                 â”‚
â”‚ ğŸ”Œ Meter No: 987654321                   â”‚
â”‚ ğŸ“ NOCS: Mirpur                          â”‚
â”‚ ğŸŸ¢ Status: Connected                     â”‚
â”‚                                          â”‚
â”‚ Select an option:"                       â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ“Š Customer Infoâ”‚ ğŸ’° Balance      â”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚ ğŸ“ˆ Monthly Bill â”‚ ğŸ’³ Recharge Histâ”‚   â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚ â”‚      ğŸ” Search Another            â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click "Monthly Bill" button â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Telegram sends callback_query            â”‚
â”‚ â”œâ”€ callback_data: "billing_12345678"     â”‚
â”‚ â”œâ”€ chat_id: 789012                       â”‚
â”‚ â””â”€ message_id: 12345 (to edit)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot handles callback                     â”‚
â”‚ â”œâ”€ Parse callback_data                   â”‚
â”‚ â”œâ”€ Action: "billing"                     â”‚
â”‚ â”œâ”€ Retrieve session data for chatId     â”‚
â”‚ â””â”€ Get monthlyBilling array              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot formats billing report:              â”‚
â”‚                                          â”‚
â”‚ "ğŸ“ˆ MONTHLY BILLING REPORT               â”‚
â”‚ Customer: 12345678                       â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”               â”‚
â”‚                                          â”‚
â”‚ ğŸ“… January 2025                          â”‚
â”‚ â€¢ Consumption: 245 kWh                   â”‚
â”‚ â€¢ Charges: à§³1,234.50                     â”‚
â”‚ â€¢ Days: 31                               â”‚
â”‚                                          â”‚
â”‚ ğŸ“… December 2024                         â”‚
â”‚ â€¢ Consumption: 198 kWh                   â”‚
â”‚ â€¢ Charges: à§³998.00                       â”‚
â”‚ â€¢ Days: 31                               â”‚
â”‚                                          â”‚
â”‚ ğŸ“… November 2024                         â”‚
â”‚ â€¢ Consumption: 223 kWh                   â”‚
â”‚ â€¢ Charges: à§³1,126.00                     â”‚
â”‚ â€¢ Days: 30                               â”‚
â”‚                                          â”‚
â”‚ ... (showing last 6 months)              â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”               â”‚
â”‚ ğŸ“Š Total Consumption: 1,456 kWh          â”‚
â”‚ ğŸ’° Total Charges: à§³7,345.00"             â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚       â¬…ï¸ Back to Menu            â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot edits previous message               â”‚
â”‚ â”œâ”€ editMessageText (Telegram API)        â”‚
â”‚ â”œâ”€ message_id: 12345                     â”‚
â”‚ â””â”€ New content: Billing report           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User sees updated message                â”‚
â”‚ Can click "Back to Menu" or other buttonsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click "Balance" button      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot shows balance:                       â”‚
â”‚                                          â”‚
â”‚ "ğŸ’° CURRENT BALANCE                      â”‚
â”‚ Customer: 12345678                       â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”               â”‚
â”‚                                          â”‚
â”‚ ğŸ’µ Current Balance: à§³234.50              â”‚
â”‚ ğŸ“Š Status: Credit                        â”‚
â”‚                                          â”‚
â”‚ (Positive balance means you have credit  â”‚
â”‚  in your account. Negative means due.)   â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”               â”‚
â”‚                                          â”‚
â”‚ Last updated: Jan 15, 2025 2:45 PM"     â”‚
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚ â”‚       â¬…ï¸ Back to Menu            â”‚     â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION: Click "Search Another"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Bot clears session for this chatId       â”‚
â”‚ Bot sends: "Please send a new Customer   â”‚
â”‚ ID or Meter Number to search."           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
        [Loop back to customer ID input]
                   â”‚
                   â–¼
                  END
```

### Journey 3: Batch Monitoring Alert Flow

```
START: Batch job running in Oracle
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Background Process: Batch Job            â”‚
â”‚ â”œâ”€ Batch Code: BMHHS                     â”‚
â”‚ â”œâ”€ Start Time: 10:00 AM                  â”‚
â”‚ â”œâ”€ Processing meter readings             â”‚
â”‚ â””â”€ Expected duration: 1-2 hours          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ (Time passes: 30 minutes)
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 10:30 AM - Scheduler Check #1            â”‚
â”‚ Batch Monitoring Scheduler runs          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query Oracle:                            â”‚
â”‚ â”œâ”€ Batch status: Running                 â”‚
â”‚ â”œâ”€ Records processed: 45,230             â”‚
â”‚ â”œâ”€ Duration: 30 minutes (1800 seconds)   â”‚
â”‚ â”œâ”€ Calculate RPS: 45230/1800 = 25.13    â”‚
â”‚ â””â”€ Status: LOW RPS (< 50) âš ï¸             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to PostgreSQL:                      â”‚
â”‚ INSERT INTO batch_execution_log          â”‚
â”‚ (batch_code, check_time, total_records,  â”‚
â”‚  rps, duration, ...)                     â”‚
â”‚ VALUES ('BMHHS', '10:30', 45230,         â”‚
â”‚         25.13, 1800, ...)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stuck Detection:                         â”‚
â”‚ â”œâ”€ Duration: 30 min (< 2 hours) âœ“       â”‚
â”‚ â”œâ”€ RPS: 25.13 (< 50) âš ï¸                  â”‚
â”‚ â”œâ”€ Previous check: None (first check)    â”‚
â”‚ â””â”€ Conclusion: NOT STUCK (first check)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send Teams Report (Regular):             â”‚
â”‚ "ğŸ”„ BATCH MONITORING REPORT               â”‚
â”‚  â€¢ Pending IMD: 15,234                   â”‚
â”‚  â€¢ Running Batches: 1                    â”‚
â”‚  â€¢ BMHHS: RPS 25.13 ğŸ”´, Duration 30m"    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ (Time passes: 30 minutes)
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11:00 AM - Scheduler Check #2            â”‚
â”‚ Batch Monitoring Scheduler runs          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query Oracle:                            â”‚
â”‚ â”œâ”€ Batch status: Running                 â”‚
â”‚ â”œâ”€ Records processed: 46,120             â”‚
â”‚ â”‚   (only +890 records in 30 min!)       â”‚
â”‚ â”œâ”€ Duration: 60 minutes (3600 seconds)   â”‚
â”‚ â”œâ”€ Calculate RPS: 46120/3600 = 12.81    â”‚
â”‚ â””â”€ Status: VERY LOW RPS ğŸ”´               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to PostgreSQL (Check #2)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stuck Detection:                         â”‚
â”‚ â”œâ”€ Duration: 60 min (< 2 hours) âœ“       â”‚
â”‚ â”œâ”€ RPS: 12.81 (< 50) âš ï¸                  â”‚
â”‚ â”œâ”€ Previous records: 45,230              â”‚
â”‚ â”œâ”€ Current records: 46,120               â”‚
â”‚ â”œâ”€ Records diff: +890 (very low growth)  â”‚
â”‚ â”œâ”€ RPS trend: DECLINING (25â†’12)         â”‚
â”‚ â””â”€ Conclusion: WARNING âš ï¸                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send Teams Report:                       â”‚
â”‚ "ğŸ”„ BATCH MONITORING REPORT               â”‚
â”‚  âš ï¸ WARNING: BMHHS showing low RPS       â”‚
â”‚  â€¢ RPS: 12.81 (declining from 25.13)    â”‚
â”‚  â€¢ Records growth: Only 890 in 30 min"   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ (Time passes: 30 minutes)
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 11:30 AM - Scheduler Check #3            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Query Oracle:                            â”‚
â”‚ â”œâ”€ Batch status: Running                 â”‚
â”‚ â”œâ”€ Records processed: 46,245             â”‚
â”‚ â”‚   (only +125 records in 30 min!)       â”‚
â”‚ â”œâ”€ Duration: 90 minutes (5400 seconds)   â”‚
â”‚ â”œâ”€ Calculate RPS: 46245/5400 = 8.56     â”‚
â”‚ â””â”€ Status: CRITICAL LOW RPS ğŸš¨           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Save to PostgreSQL (Check #3)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stuck Detection:                         â”‚
â”‚ â”œâ”€ Duration: 90 min (1.5 hours)          â”‚
â”‚ â”œâ”€ RPS: 8.56 (< 1) ğŸš¨                    â”‚
â”‚ â”œâ”€ Previous records: 46,120              â”‚
â”‚ â”œâ”€ Current records: 46,245               â”‚
â”‚ â”œâ”€ Records diff: +125 (MINIMAL growth!)  â”‚
â”‚ â”œâ”€ RPS trend: DECLINING (12â†’8)          â”‚
â”‚ â”œâ”€ Conditions met:                       â”‚
â”‚ â”‚   â€¢ RPS < 1 âœ“                          â”‚
â”‚ â”‚   â€¢ Duration > 10 min âœ“                â”‚
â”‚ â”‚   â€¢ Records barely increasing âœ“        â”‚
â”‚ â””â”€ Conclusion: STUCK! ğŸš¨                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Check if alert already sent              â”‚
â”‚ Query: batch_monitoring_alert            â”‚
â”‚ WHERE batch_code = 'BMHHS'               â”‚
â”‚   AND alert_type = 'STUCK'               â”‚
â”‚   AND sent_at > NOW() - INTERVAL '2h'   â”‚
â”‚ Result: NOT FOUND (first stuck alert)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send MS Teams STUCK ALERT                â”‚
â”‚ Webhook: ALERTS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Format Adaptive Card:                    â”‚
â”‚                                          â”‚
â”‚ â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—â”‚
â”‚ â•‘  ğŸš¨ BATCH STUCK ALERT                 â•‘â”‚
â”‚ â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”‚
â”‚                                          â”‚
â”‚ âš ï¸ Batch: BMHHS                          â”‚
â”‚ Reason: Duration > 90 minutes and        â”‚
â”‚         RPS critically low (< 10)        â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”         â”‚
â”‚ ğŸ“Š Current Status:                       â”‚
â”‚ â€¢ Start Time: 10:00 AM                   â”‚
â”‚ â€¢ Duration: 1h 30m                       â”‚
â”‚ â€¢ Records: 46,245                        â”‚
â”‚ â€¢ RPS: 8.56 ğŸ”´                           â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”         â”‚
â”‚ ğŸ“‰ Comparison with Previous Check:       â”‚
â”‚ â€¢ Previous Records: 46,120               â”‚
â”‚ â€¢ Current Records: 46,245                â”‚
â”‚ â€¢ Records Diff: +125                     â”‚
â”‚ â€¢ Previous RPS: 12.81                    â”‚
â”‚ â€¢ Current RPS: 8.56                      â”‚
â”‚ â€¢ Trend: DECLINING ğŸ“‰                    â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”         â”‚
â”‚ Alert Time: Jan 15, 2025 11:30 AM       â”‚
â”‚ DPDC AMI Batch Monitoring System        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST to Teams Webhook                    â”‚
â”‚ URL: https://oculintech.webhook...      â”‚
â”‚ Body: { type: "message",                 â”‚
â”‚         attachments: [adaptive_card] }   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mark alert as sent:                      â”‚
â”‚ INSERT INTO batch_monitoring_alert       â”‚
â”‚ (batch_code, alert_type, sent_at, ...)  â”‚
â”‚ VALUES ('BMHHS', 'STUCK', NOW(), ...)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MS Teams Channel                         â”‚
â”‚ Team members receive notification:       â”‚
â”‚ â€¢ Desktop notification                   â”‚
â”‚ â€¢ Mobile push notification               â”‚
â”‚ â€¢ Red badge on Teams icon                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Team Lead sees alert in Teams            â”‚
â”‚ â”œâ”€ Reads stuck batch details             â”‚
â”‚ â”œâ”€ Checks Oracle database directly       â”‚
â”‚ â”œâ”€ Identifies issue: Lock contention     â”‚
â”‚ â””â”€ Takes corrective action               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Team Lead resolves issue                 â”‚
â”‚ â”œâ”€ Releases lock                         â”‚
â”‚ â”œâ”€ Batch resumes processing              â”‚
â”‚ â””â”€ RPS increases to normal (> 100)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”‚ (Time passes: 30 minutes)
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 12:00 PM - Scheduler Check #4            â”‚
â”‚ â”œâ”€ Query Oracle                          â”‚
â”‚ â”œâ”€ Records: 68,450 (+22,205 in 30 min!) â”‚
â”‚ â”œâ”€ RPS: 123.45 ğŸŸ¢ (RECOVERED!)           â”‚
â”‚ â””â”€ Status: Normal                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Send Teams Report:                       â”‚
â”‚ "ğŸ”„ BATCH MONITORING REPORT               â”‚
â”‚  âœ… BMHHS has RECOVERED                  â”‚
â”‚  â€¢ RPS: 123.45 ğŸŸ¢ (back to normal)       â”‚
â”‚  â€¢ Records: 68,450                       â”‚
â”‚  â€¢ All batches running smoothly"         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
                  END
```

---

## 4. INTEGRATION FLOWCHARTS

### Integration 1: Telegram Bot Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    TELEGRAM BOT INTEGRATION ARCHITECTURE                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELEGRAM INFRASTRUCTURE                                                â”‚
â”‚  â”œâ”€ Telegram Servers (cloud-based)                                      â”‚
â”‚  â”œâ”€ Bot API: api.telegram.org                                           â”‚
â”‚  â”œâ”€ Bot Token: 8575870159:AAHupxIlKBLpBS_7PEY9t41qfeNLdl8tobk          â”‚
â”‚  â””â”€ Bot Username: @DPDC_customerInfo_bot                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ Polling (300ms interval)
                      â”‚ GET /bot{token}/getUpdates?offset={last_update_id}
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND SERVICE: telegram-bot.service.js                               â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  POLLING LOOP (Infinite)                                       â”‚   â”‚
â”‚  â”‚  while (true) {                                                â”‚   â”‚
â”‚  â”‚    try {                                                       â”‚   â”‚
â”‚  â”‚      updates = await getUpdates()                             â”‚   â”‚
â”‚  â”‚      for (update in updates) {                                 â”‚   â”‚
â”‚  â”‚        processUpdate(update)                                   â”‚   â”‚
â”‚  â”‚      }                                                          â”‚   â”‚
â”‚  â”‚      await sleep(300ms)                                        â”‚   â”‚
â”‚  â”‚    } catch (error) {                                           â”‚   â”‚
â”‚  â”‚      log error                                                 â”‚   â”‚
â”‚  â”‚      await sleep(5000ms) // longer delay on error             â”‚   â”‚
â”‚  â”‚    }                                                           â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  UPDATE PROCESSOR                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Identify update type:                                      â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ message (text, command)                                â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ callback_query (button press)                          â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ edited_message                                         â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Extract data:                                              â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ chat_id (user identifier)                              â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ message_id (for editing)                               â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ text / callback_data                                    â”‚   â”‚
â”‚  â”‚  â”‚   â€¢ user info (username, first_name)                       â”‚   â”‚
â”‚  â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â””â”€ Route to handler                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MESSAGE HANDLERS                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ /start command â†’ handleStartCommand()                      â”‚   â”‚
â”‚  â”‚  â”œâ”€ Customer ID (digits) â†’ handleCustomerSearch()              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Meter number â†’ handleMeterSearch()                         â”‚   â”‚
â”‚  â”‚  â””â”€ Other text â†’ handleUnknownMessage()                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  CALLBACK QUERY HANDLERS                                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ "info_{custId}" â†’ showCustomerInfo()                       â”‚   â”‚
â”‚  â”‚  â”œâ”€ "balance_{custId}" â†’ showBalance()                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ "billing_{custId}" â†’ showMonthlyBilling()                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ "recharge_{custId}" â†’ showRechargeHistory()                â”‚   â”‚
â”‚  â”‚  â””â”€ "search_new" â†’ clearSession() + askForNewSearch()          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SESSION MANAGEMENT (In-Memory Map)                            â”‚   â”‚
â”‚  â”‚  Key: chatId (number)                                          â”‚   â”‚
â”‚  â”‚  Value: {                                                       â”‚   â”‚
â”‚  â”‚    customerInfo: {...},                                        â”‚   â”‚
â”‚  â”‚    billingData: [...],                                         â”‚   â”‚
â”‚  â”‚    monthlyBilling: [...],                                      â”‚   â”‚
â”‚  â”‚    rechargeHistory: [...],                                     â”‚   â”‚
â”‚  â”‚    analytics: {...},                                           â”‚   â”‚
â”‚  â”‚    timestamp: Date.now(),                                      â”‚   â”‚
â”‚  â”‚    expiresAt: Date.now() + 30*60*1000 // 30 min TTL          â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Cleanup: setInterval(() => {                                  â”‚   â”‚
â”‚  â”‚    removeExpiredSessions()                                     â”‚   â”‚
â”‚  â”‚  }, 5*60*1000) // every 5 minutes                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ORACLE QUERY EXECUTION                                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ Use Reports Service to execute SQL files                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ customer_details_search.sql                               â”‚   â”‚
â”‚  â”‚  â”œâ”€ customer_billing_details.sql                               â”‚   â”‚
â”‚  â”‚  â””â”€ customer_recharge_history.sql                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  DATA AGGREGATION                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€ Daily billing â†’ Monthly aggregation                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ Calculate totals (consumption, charges)                    â”‚   â”‚
â”‚  â”‚  â”œâ”€ Calculate averages                                         â”‚   â”‚
â”‚  â”‚  â”œâ”€ Reverse balance sign (DB * -1)                             â”‚   â”‚
â”‚  â”‚  â””â”€ Sort recharge history by date                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  MESSAGE FORMATTING                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ Use emoji for visual appeal                                â”‚   â”‚
â”‚  â”‚  â”œâ”€ Format currency (à§³ symbol, thousands separator)            â”‚   â”‚
â”‚  â”‚  â”œâ”€ Format dates (readable format)                             â”‚   â”‚
â”‚  â”‚  â”œâ”€ Add section separators (â”â”â”)                               â”‚   â”‚
â”‚  â”‚  â””â”€ Limit message length (Telegram 4096 char limit)            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  TELEGRAM API CALLS                                            â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendMessage(chat_id, text, reply_markup)                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ editMessageText(chat_id, message_id, text, reply_markup)   â”‚   â”‚
â”‚  â”‚  â”œâ”€ answerCallbackQuery(callback_query_id, text)               â”‚   â”‚
â”‚  â”‚  â””â”€ All calls include error handling & retry logic             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ API Calls
                      â”‚ POST /bot{token}/sendMessage
                      â”‚ POST /bot{token}/editMessageText
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  TELEGRAM SERVERS                                                        â”‚
â”‚  â”œâ”€ Process message                                                     â”‚
â”‚  â”œâ”€ Deliver to user's device                                            â”‚
â”‚  â””â”€ Send push notification                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER'S TELEGRAM APP (Mobile/Desktop/Web)                               â”‚
â”‚  â”œâ”€ Receive message                                                     â”‚
â”‚  â”œâ”€ Display formatted text                                              â”‚
â”‚  â”œâ”€ Render inline keyboard buttons                                      â”‚
â”‚  â””â”€ User can interact (click buttons, send messages)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


MESSAGE FLOW SEQUENCE:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. User sends message â†’ Telegram servers â†’ Bot polls update
2. Bot processes message â†’ Executes Oracle queries â†’ Aggregates data
3. Bot stores in session â†’ Formats response â†’ Sends to Telegram
4. Telegram delivers to user â†’ User sees message with buttons
5. User clicks button â†’ Telegram sends callback â†’ Bot handles callback
6. Bot retrieves session data â†’ Formats report â†’ Edits message
7. User sees updated message â†’ Can interact further

ERROR HANDLING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ Polling errors: Log & continue with delay
â€¢ Oracle errors: Send user-friendly error message
â€¢ Timeout: "Query taking too long, please try again"
â€¢ Not found: "Customer not found, please check ID"
â€¢ Invalid format: "Please send a valid customer ID (numbers only)"
â€¢ Rate limiting: Track requests per user, limit to 10/min
```

### Integration 2: MS Teams Webhooks Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                MS TEAMS WEBHOOKS INTEGRATION ARCHITECTURE                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MS TEAMS INFRASTRUCTURE                                                â”‚
â”‚  â”œâ”€ Microsoft Teams (Office 365)                                        â”‚
â”‚  â”œâ”€ Incoming Webhook Connector                                          â”‚
â”‚  â”œâ”€ Webhook URLs (per channel):                                         â”‚
â”‚  â”‚   â€¢ DEFAULT: https://oculintech.webhook.office.com/webhookb2/...    â”‚
â”‚  â”‚   â€¢ BATCH_MONITORING: (same URL, different channel possible)        â”‚
â”‚  â”‚   â€¢ ALERTS: (same URL, different channel possible)                  â”‚
â”‚  â””â”€ Team: DPDC AMI Monitoring                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ Outgoing only (Push mode)
                      â”‚ POST {webhook_url}
                      â”‚
                      â–²
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND SERVICE: teams.service.js                                      â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  INITIALIZATION                                                â”‚   â”‚
â”‚  â”‚  initialize(webhookUrl) {                                      â”‚   â”‚
â”‚  â”‚    this.webhookUrl = webhookUrl                               â”‚   â”‚
â”‚  â”‚    logger.info('Teams service initialized')                    â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SEND METHODS                                                  â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendTextMessage(text) - Simple text                        â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendAdaptiveCard(card) - Rich card (primary method)        â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendRCDCDashboard(data) - RC/DC report                     â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendNOCSBreakdown(data) - NOCS breakdown                   â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendNOCSBalance(data) - NOCS balance (full)                â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendNOCSBalanceSummaryOnly(data) - Summary only            â”‚   â”‚
â”‚  â”‚  â”œâ”€ sendBatchMonitoringReport(data) - Batch report             â”‚   â”‚
â”‚  â”‚  â””â”€ sendBatchStuckAlert(data, stuckInfo) - Stuck alert         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ADAPTIVE CARD FORMATTERS                                      â”‚   â”‚
â”‚  â”‚  (All return JSON conforming to Adaptive Card schema v1.4)     â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  formatRCDCDashboardCard(data):                                â”‚   â”‚
â”‚  â”‚  {                                                              â”‚   â”‚
â”‚  â”‚    $schema: 'http://adaptivecards.io/schemas/...',            â”‚   â”‚
â”‚  â”‚    type: 'AdaptiveCard',                                       â”‚   â”‚
â”‚  â”‚    version: '1.4',                                             â”‚   â”‚
â”‚  â”‚    body: [                                                      â”‚   â”‚
â”‚  â”‚      { type: 'Container', style: 'emphasis',                   â”‚   â”‚
â”‚  â”‚        items: [                                                 â”‚   â”‚
â”‚  â”‚          { type: 'TextBlock', text: 'ğŸ“Š RC/DC DASHBOARD',      â”‚   â”‚
â”‚  â”‚            size: 'Large', weight: 'Bolder', ... }              â”‚   â”‚
â”‚  â”‚        ]                                                        â”‚   â”‚
â”‚  â”‚      },                                                         â”‚   â”‚
â”‚  â”‚      { type: 'Container',                                      â”‚   â”‚
â”‚  â”‚        items: [                                                 â”‚   â”‚
â”‚  â”‚          { type: 'TextBlock', text: 'ğŸ”„ Remote Connect'... },  â”‚   â”‚
â”‚  â”‚          { type: 'FactSet',                                    â”‚   â”‚
â”‚  â”‚            facts: [                                             â”‚   â”‚
â”‚  â”‚              { title: 'Total:', value: data.rc.total },        â”‚   â”‚
â”‚  â”‚              { title: 'âœ… Normal:', value: data.rc.normal },   â”‚   â”‚
â”‚  â”‚              ...                                                â”‚   â”‚
â”‚  â”‚            ]                                                    â”‚   â”‚
â”‚  â”‚          }                                                      â”‚   â”‚
â”‚  â”‚        ]                                                        â”‚   â”‚
â”‚  â”‚      },                                                         â”‚   â”‚
â”‚  â”‚      ... (DC section, timestamp)                               â”‚   â”‚
â”‚  â”‚    ]                                                            â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  formatBatchMonitoringCard(data):                              â”‚   â”‚
â”‚  â”‚  â€¢ Header: "ğŸ”„ BATCH MONITORING REPORT"                        â”‚   â”‚
â”‚  â”‚  â€¢ Pending IMD section (with count & color coding)             â”‚   â”‚
â”‚  â”‚  â€¢ Running batches section:                                    â”‚   â”‚
â”‚  â”‚    FOR EACH batch:                                             â”‚   â”‚
â”‚  â”‚    - Batch code with status icon (ğŸŸ¢/ğŸŸ¡/ğŸ”´)                    â”‚   â”‚
â”‚  â”‚    - RPS (color-coded by value)                                â”‚   â”‚
â”‚  â”‚    - Start time, duration, records                             â”‚   â”‚
â”‚  â”‚  â€¢ 24-hour statistics section (if available)                   â”‚   â”‚
â”‚  â”‚  â€¢ Timestamp                                                    â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  formatBatchStuckAlertCard(batchData, stuckInfo):              â”‚   â”‚
â”‚  â”‚  â€¢ Header: "ğŸš¨ BATCH STUCK ALERT" (attention style)            â”‚   â”‚
â”‚  â”‚  â€¢ Batch code & stuck reason                                   â”‚   â”‚
â”‚  â”‚  â€¢ Current status (start time, duration, RPS, records)         â”‚   â”‚
â”‚  â”‚  â€¢ Comparison with previous check (trend analysis)             â”‚   â”‚
â”‚  â”‚  â€¢ Alert timestamp                                             â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  formatNOCSBalanceSummaryOnlyCard(summaryData):                â”‚   â”‚
â”‚  â”‚  â€¢ Header: "ğŸ’° NOCS Balance - Overall Summary"                 â”‚   â”‚
â”‚  â”‚  â€¢ FactSet with:                                               â”‚   â”‚
â”‚  â”‚    - Total NOCS areas                                          â”‚   â”‚
â”‚  â”‚    - Total customers                                           â”‚   â”‚
â”‚  â”‚    - Credit balance (with customer count)                      â”‚   â”‚
â”‚  â”‚    - Due balance (with customer count)                         â”‚   â”‚
â”‚  â”‚    - Net balance                                               â”‚   â”‚
â”‚  â”‚  â€¢ Last updated timestamp                                      â”‚   â”‚
â”‚  â”‚  â€¢ Uses Indian number formatting (lakhs/crores)                â”‚   â”‚
â”‚  â”‚  â€¢ Uses à§³ symbol for currency                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  SEND ADAPTIVE CARD IMPLEMENTATION                             â”‚   â”‚
â”‚  â”‚  async sendAdaptiveCard(card) {                                â”‚   â”‚
â”‚  â”‚    // Skip in development (optional)                           â”‚   â”‚
â”‚  â”‚    // if (process.env.NODE_ENV !== 'production') return        â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚    // Validate webhook URL                                     â”‚   â”‚
â”‚  â”‚    if (!this.webhookUrl) {                                     â”‚   â”‚
â”‚  â”‚      throw new Error('Teams webhook URL not configured')       â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚    // Prepare payload                                          â”‚   â”‚
â”‚  â”‚    const payload = {                                           â”‚   â”‚
â”‚  â”‚      type: 'message',                                          â”‚   â”‚
â”‚  â”‚      attachments: [                                            â”‚   â”‚
â”‚  â”‚        {                                                        â”‚   â”‚
â”‚  â”‚          contentType: 'application/vnd.microsoft.card.adaptive'â”‚   â”‚
â”‚  â”‚          contentUrl: null,                                     â”‚   â”‚
â”‚  â”‚          content: card  // Adaptive Card JSON                  â”‚   â”‚
â”‚  â”‚        }                                                        â”‚   â”‚
â”‚  â”‚      ]                                                          â”‚   â”‚
â”‚  â”‚    }                                                            â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚    // POST to Teams webhook                                    â”‚   â”‚
â”‚  â”‚    const response = await axios.post(                          â”‚   â”‚
â”‚  â”‚      this.webhookUrl,                                          â”‚   â”‚
â”‚  â”‚      payload,                                                   â”‚   â”‚
â”‚  â”‚      {                                                          â”‚   â”‚
â”‚  â”‚        headers: {                                              â”‚   â”‚
â”‚  â”‚          'Content-Type': 'application/json'                    â”‚   â”‚
â”‚  â”‚        },                                                       â”‚   â”‚
â”‚  â”‚        timeout: 10000  // 10 second timeout                    â”‚   â”‚
â”‚  â”‚      }                                                          â”‚   â”‚
â”‚  â”‚    )                                                            â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚    // Log success                                              â”‚   â”‚
â”‚  â”‚    logger.info('Teams adaptive card sent successfully')        â”‚   â”‚
â”‚  â”‚    return { success: true, response: response.data }           â”‚   â”‚
â”‚  â”‚  }                                                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  HELPER FUNCTIONS                                              â”‚   â”‚
â”‚  â”‚  formatDuration(seconds):                                      â”‚   â”‚
â”‚  â”‚    â€¢ Convert seconds to "Xh Ym" format                         â”‚   â”‚
â”‚  â”‚    â€¢ Example: 3665 â†’ "1h 1m"                                   â”‚   â”‚
â”‚  â”‚                                                                 â”‚   â”‚
â”‚  â”‚  Color coding logic:                                           â”‚   â”‚
â”‚  â”‚    â€¢ RPS >= 100: 'Good' (green ğŸŸ¢)                             â”‚   â”‚
â”‚  â”‚    â€¢ RPS >= 50: 'Attention' (yellow ğŸŸ¡)                        â”‚   â”‚
â”‚  â”‚    â€¢ RPS < 50: 'Warning' (red ğŸ”´)                              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ Triggered by:
                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚            â”‚            â”‚                    â”‚
         â–¼            â–¼            â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NOCS Bal.  â”‚ â”‚ Batch Mon. â”‚ â”‚ Teams Rep.   â”‚ â”‚ Manual Trigger â”‚
â”‚ Scheduler  â”‚ â”‚ Scheduler  â”‚ â”‚ Scheduler    â”‚ â”‚ (Testing)      â”‚
â”‚ (Hourly)   â”‚ â”‚ (30 min)   â”‚ â”‚ (Hourly)     â”‚ â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚            â”‚            â”‚                    â”‚
         â”‚            â”‚            â”‚                    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SCHEDULERS CALL TEAMS SERVICE                                          â”‚
â”‚                                                                          â”‚
â”‚  Example: teams-reports.scheduler.js (Every 60 min)                     â”‚
â”‚  â”œâ”€ Fetch NOCS balance summary from PostgreSQL cache                    â”‚
â”‚  â”œâ”€ Calculate totals (aggregate all NOCS)                               â”‚
â”‚  â”œâ”€ Prepare summaryData object                                          â”‚
â”‚  â”œâ”€ Initialize teams service with webhook URL                           â”‚
â”‚  â”‚   teamsService.initialize(teamsWebhooks.DEFAULT)                     â”‚
â”‚  â”œâ”€ Send report:                                                        â”‚
â”‚  â”‚   await teamsService.sendNOCSBalanceSummaryOnly(summaryData)         â”‚
â”‚  â””â”€ Log success/failure                                                 â”‚
â”‚                                                                          â”‚
â”‚  Example: batch-monitoring.scheduler.js (Every 30 min)                  â”‚
â”‚  â”œâ”€ Get pending IMD count                                               â”‚
â”‚  â”œâ”€ Monitor all running batches                                         â”‚
â”‚  â”œâ”€ Calculate RPS for each batch                                        â”‚
â”‚  â”œâ”€ Detect stuck batches                                                â”‚
â”‚  â”œâ”€ Save statistics to PostgreSQL                                       â”‚
â”‚  â”œâ”€ IF stuck batches:                                                   â”‚
â”‚  â”‚   â”œâ”€ teamsService.initialize(teamsWebhooks.ALERTS)                   â”‚
â”‚  â”‚   â””â”€ teamsService.sendBatchStuckAlert(batchData, stuckInfo)          â”‚
â”‚  â”œâ”€ Format monitoring report                                            â”‚
â”‚  â”œâ”€ teamsService.initialize(teamsWebhooks.BATCH_MONITORING)             â”‚
â”‚  â””â”€ teamsService.sendBatchMonitoringReport(reportData)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ POST request
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MS TEAMS WEBHOOK ENDPOINT                                              â”‚
â”‚  https://oculintech.webhook.office.com/webhookb2/...                    â”‚
â”‚                                                                          â”‚
â”‚  â”œâ”€ Validate request (Content-Type, payload structure)                  â”‚
â”‚  â”œâ”€ Parse Adaptive Card JSON                                            â”‚
â”‚  â”œâ”€ Render card in Teams message format                                 â”‚
â”‚  â”œâ”€ Post to specified channel                                           â”‚
â”‚  â””â”€ Return success (HTTP 200) or error                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MS TEAMS CHANNEL                                                        â”‚
â”‚  Channel: "DPDC AMI Monitoring" or "DPDC Alerts"                        â”‚
â”‚                                                                          â”‚
â”‚  â”œâ”€ Message posted to channel                                           â”‚
â”‚  â”œâ”€ Adaptive Card rendered with rich formatting                         â”‚
â”‚  â”œâ”€ Team members notified:                                              â”‚
â”‚  â”‚   â€¢ Desktop notification (if Teams open)                             â”‚
â”‚  â”‚   â€¢ Mobile push notification                                         â”‚
â”‚  â”‚   â€¢ Email notification (configurable)                                â”‚
â”‚  â”‚   â€¢ Activity badge on Teams icon                                     â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â”œâ”€ Card displays:                                                      â”‚
â”‚  â”‚   â€¢ Header with icon & title                                         â”‚
â”‚  â”‚   â€¢ Sections with formatted data                                     â”‚
â”‚  â”‚   â€¢ Color-coded status indicators                                    â”‚
â”‚  â”‚   â€¢ Fact sets (key-value pairs)                                      â”‚
â”‚  â”‚   â€¢ Timestamp                                                        â”‚
â”‚  â”‚                                                                       â”‚
â”‚  â””â”€ Team members can:                                                   â”‚
â”‚      â€¢ Read message                                                     â”‚
â”‚      â€¢ React with emoji                                                 â”‚
â”‚      â€¢ Reply in thread                                                  â”‚
â”‚      â€¢ Pin important messages                                           â”‚
â”‚      â€¢ Forward to other channels                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ADAPTIVE CARD EXAMPLE (Batch Stuck Alert):
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{
  "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",
  "type": "AdaptiveCard",
  "version": "1.4",
  "body": [
    {
      "type": "Container",
      "style": "attention",  // Red/orange background
      "items": [
        {
          "type": "TextBlock",
          "text": "ğŸš¨ BATCH STUCK ALERT",
          "size": "ExtraLarge",
          "weight": "Bolder",
          "color": "Attention",
          "horizontalAlignment": "Center"
        }
      ]
    },
    {
      "type": "Container",
      "separator": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "âš ï¸ Batch: **BMHHS**",
          "size": "Large",
          "weight": "Bolder"
        },
        {
          "type": "TextBlock",
          "text": "Duration > 2 hours and RPS critically low",
          "wrap": true
        }
      ]
    },
    {
      "type": "Container",
      "separator": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "ğŸ“Š Current Status",
          "weight": "Bolder"
        },
        {
          "type": "FactSet",
          "facts": [
            { "title": "â° Start Time:", "value": "10:00 AM" },
            { "title": "â±ï¸ Duration:", "value": "2h 15m" },
            { "title": "ğŸ“Š Records:", "value": "46,245" },
            { "title": "ğŸ“ˆ RPS:", "value": "8.56" }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "separator": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "ğŸ“‰ Comparison",
          "weight": "Bolder"
        },
        {
          "type": "FactSet",
          "facts": [
            { "title": "Previous RPS:", "value": "12.81" },
            { "title": "Current RPS:", "value": "8.56" },
            { "title": "Trend:", "value": "DECLINING ğŸ“‰" }
          ]
        }
      ]
    },
    {
      "type": "Container",
      "separator": true,
      "items": [
        {
          "type": "TextBlock",
          "text": "Alert Time: Jan 15, 2025 11:30 AM",
          "size": "Small",
          "horizontalAlignment": "Center"
        }
      ]
    }
  ]
}

RENDERED IN TEAMS:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸš¨ BATCH STUCK ALERT                     â•‘  â† Red/orange header
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸ Batch: BMHHS
Duration > 2 hours and RPS critically low
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š Current Status
â° Start Time:    10:00 AM
â±ï¸ Duration:      2h 15m
ğŸ“Š Records:       46,245
ğŸ“ˆ RPS:           8.56
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“‰ Comparison
Previous RPS:    12.81
Current RPS:     8.56
Trend:           DECLINING ğŸ“‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Alert Time: Jan 15, 2025 11:30 AM


ERROR HANDLING:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ Network errors: Log & retry (up to 3 attempts)
â€¢ Webhook URL invalid: Skip send, log error
â€¢ Timeout: 10 second timeout, then fail gracefully
â€¢ Rate limiting: Teams has limits (~20 messages/min per webhook)
â€¢ Payload too large: Split into multiple cards if needed
â€¢ Card validation errors: Log full card JSON for debugging
```

---

## 5. PAGE-BY-PAGE DETAILED DOCUMENTATION

[The complete 21-page documentation will continue in the file...]

